<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Study Buddy - Multiple Choice</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/tailwindcss/2.2.19/tailwind.min.css" rel="stylesheet">
    <style>
        .flip-card {
            perspective: 1000px;
            height: 200px;
        }
        .flip-card-inner {
            position: relative;
            width: 100%;
            height: 100%;
            transition: transform 0.6s;
            transform-style: preserve-3d;
        }
        .flip-card.flipped .flip-card-inner {
            transform: rotateY(180deg);
        }
        .flip-card-front, .flip-card-back {
            position: absolute;
            width: 100%;
            height: 100%;
            backface-visibility: hidden;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            padding: 20px;
        }
        .flip-card-back {
            transform: rotateY(180deg);
        }
    </style>
</head>
<body class="bg-gray-100 p-6">
    <div class="max-w-4xl mx-auto">
        <!-- Input Section -->
        <div class="bg-white rounded-lg shadow p-6 mb-6">
            <h1 class="text-2xl font-bold mb-4">Study Buddy</h1>
            <textarea 
                id="notesInput" 
                class="w-full h-40 p-4 border rounded"
                placeholder="Paste your notes here..."
            ></textarea>
            <button 
                onclick="createStudyMaterials()" 
                class="mt-4 w-full bg-blue-500 text-white px-6 py-3 rounded hover:bg-blue-600"
            >
                Create Study Materials
            </button>
        </div>

        <!-- Study Materials -->
        <div id="quizSection" class="hidden">
            <div class="bg-white rounded-lg shadow p-6">
                <h2 class="text-xl font-bold mb-4">Multiple Choice Quiz</h2>
                <div id="quizContainer" class="space-y-6"></div>
                <button 
                    onclick="checkAnswers()" 
                    class="mt-6 w-full bg-green-500 text-white px-6 py-3 rounded hover:bg-green-600"
                >
                    Check Answers
                </button>
            </div>
        </div>
    </div>

    <script>
        let quizQuestions = [];

        function createStudyMaterials() {
            const notes = document.getElementById('notesInput').value;
            if (!notes.trim()) {
                alert('Please enter some notes first!');
                return;
            }

            // Split into sentences
            const sentences = notes.split(/[.!?]+/)
                .map(s => s.trim())
                .filter(s => s.length > 10);

            // Create questions
            quizQuestions = [];
            const usedSentences = new Set();

            sentences.forEach(sentence => {
                if (usedSentences.has(sentence)) return;

                const words = sentence.split(' ');
                const keyWords = words.filter(word => 
                    word.length > 5 && 
                    !isCommonWord(word.toLowerCase())
                );

                if (keyWords.length > 0) {
                    // Pick a random keyword for the question
                    const correctAnswer = keyWords[Math.floor(Math.random() * keyWords.length)];
                    
                    // Create wrong answers from other keywords in different sentences
                    const otherKeywords = sentences
                        .filter(s => s !== sentence)
                        .flatMap(s => s.split(' '))
                        .filter(w => w.length > 5 && !isCommonWord(w.toLowerCase()))
                        .filter(w => w !== correctAnswer);

                    // Get 3 random wrong answers
                    const wrongAnswers = shuffleArray(Array.from(new Set(otherKeywords)))
                        .slice(0, 3);

                    if (wrongAnswers.length === 3) {
                        quizQuestions.push({
                            question: sentence,
                            correctAnswer: correctAnswer,
                            allAnswers: shuffleArray([...wrongAnswers, correctAnswer])
                        });
                        usedSentences.add(sentence);
                    }
                }
            });

            // Show quiz section
            document.getElementById('quizSection').classList.remove('hidden');
            createQuiz();
        }

        function createQuiz() {
            const container = document.getElementById('quizContainer');
            container.innerHTML = quizQuestions.map((q, i) => `
                <div class="bg-gray-50 p-6 rounded-lg">
                    <p class="font-bold mb-4">Question ${i + 1}:</p>
                    <p class="mb-4">${q.question}</p>
                    <div class="space-y-2">
                        ${q.allAnswers.map((answer, j) => `
                            <div class="flex items-center">
                                <input type="radio" 
                                       id="q${i}a${j}" 
                                       name="q${i}" 
                                       value="${answer}"
                                       class="mr-3">
                                <label for="q${i}a${j}">${answer}</label>
                            </div>
                        `).join('')}
                    </div>
                </div>
            `).join('');
        }

        function checkAnswers() {
            let score = 0;
            quizQuestions.forEach((q, i) => {
                const selected = document.querySelector(`input[name="q${i}"]:checked`)?.value;
                if (selected === q.correctAnswer) {
                    score++;
                }
            });
            alert(`You got ${score} out of ${quizQuestions.length} correct!`);
        }

        function isCommonWord(word) {
            return ['about', 'above', 'after', 'again', 'their', 'there', 'these', 
                    'those', 'which', 'while', 'would', 'because', 'could', 'should',
                    'through', 'during', 'before', 'within'].includes(word);
        }

        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }
    </script>
</body>
</html>
